# 최종2-1
# 비디오 영상 프레임 캡처
import cv2
import time
import os

# 영상 업로드
video_path = '/content/drive/MyDrive/project2_Object_Detection_YOLO/IMG_8351_1.mov'  # 비디오 파일 경로
camera = cv2.VideoCapture(video_path)

# 프레임 이미지를 저장할 폴더 경로
output_folder = '/content/drive/MyDrive/project2_Object_Detection_YOLO/data_image'
os.makedirs(output_folder, exist_ok=True)

# 캡처할 시간 간격 (초)
capture_interval = 30

# 저장할 최대 프레임 개수
max_frames = 100

start_time = time.time()  # 동영상 촬영 시작 시간
frame_index = 0  # 프레임 인덱스 초기화

while True:
    # 프레임 읽기
    ret, frame = camera.read()

    # 프레임 읽기에 실패하거나 최대 프레임 개수에 도달하면 반복 종료
    if not ret or frame_index >= max_frames:
        break

    # 동영상 프레임 저장
    elapsed_time = time.time() - start_time
    if elapsed_time >= capture_interval:
        image_path = os.path.join(output_folder, f'frame_{frame_index}.jpg')
        cv2.imwrite(image_path, frame)
        frame_index += 1
        start_time += capture_interval  # 다음 캡처 시작 시간 업데이트

# 카메라 닫기
camera.release()

print(f'비디오 프레임 캡처가 완료되었습니다. 총 {frame_index}개의 프레임이 저장되었습니다.')
